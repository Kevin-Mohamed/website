+function(e,t,n){var r=e.location,s=jQuery.noConflict(),o=function(){function h(){var e=s("#header").data("page"),t=s("#all-search-results"),r=s("#top-system-message").children(".system-message-close"),i=e["history"]==1?1:n;i&&s.post("/rest/history",{ref:e.ref,name:e.name,id:e.id,"class":e["class"],type:e.type,is_obj:e.is_obj}),s(".user-history").size()>0&&p(i),k(e["class"]),r.size()>0&&(w("show"),r.click(function(){w("hide",r.data("id"))})),W.init(e),X.init(e),s(".star-status-"+e.wbid).size()>0&&s(".star-status-"+e.wbid).load("/rest/workbench/star?wbid="+e.wbid+"&name="+e.name+"&class="+e["class"]+"&type="+e.type+"&id="+e.id+"&url="+e.ref+"&save_to="+e.save+"&is_obj="+e.is_obj),R(e.ref),e.notify&&b(e.notify),d(),v();if(t.size()>0){var o=t.data("search");P(o.type,o.species,o.query)}else m();g()}function p(e){var t=s("#user_history-content");S(s(".user-history"),"/rest/history?sidebar=1"),t.size()>0&&t.text().length>4&&S(t,"/rest/history"),e&&setTimeout(p,6e5),j("activity");return}function d(){N(),s("#nav-bar").find("ul li").hover(function(){var e=s(this);s("div.columns>ul").hide(),o&&(e.siblings("li").children("ul.wb-dropdown").hide(),e.siblings("li").children("a").removeClass("hover"),e.children("ul.wb-dropdown").find("a").removeClass("hover"),e.children("ul.wb-dropdown").find("ul.wb-dropdown").hide(),clearTimeout(o),o=n),e.children("ul.wb-dropdown").show(),e.children("a").addClass("hover")},function(){var e=s(this);o&&(clearTimeout(o),o=n),o=setTimeout(function(){e.children("ul.wb-dropdown").hide(),e.children("a").removeClass("hover")},300)}),S(s(".status-bar"),"/rest/auth",n,function(){s("#bench-status").load("/rest/workbench");var t=s("#login");t.size()>0?t.click(function(){s(this).toggleClass("open ui-corner-top").siblings().toggle()}):s("#logout").click(function(){e.open("/logout","pop","status=no,resizable=yes,height=2px,width=2px").blur()})})}function v(){var e=s("#person-search"),t=s("#column-dropdown");x(),s("#print").click(function(){var e=r.hash.replace("#",""),t=s(this);s.ajax({type:"POST",url:"/rest/print",data:{layout:e},beforeSend:function(){E(t)},success:function(e){t.html(""),r.href=e},error:function(e,t,n){alert(e+" "+t+" "+n)}})}),s(".section-button").click(function(){var e=s(this).attr("wname");s("#nav-"+e).trigger("open"),q.goToAnchor(e)}),s(".sortable").size()>0&&s(".sortable").sortable({handle:".widget-header, #widget-footer",items:"li.widget",placeholder:"placeholder",connectWith:".sortable",opacity:.6,forcePlaceholderSize:!0,update:function(e,t){I.updateLayout()}}),t.hover(function(){o&&(s("#nav-bar").find("ul li .hover").removeClass("hover"),s("#nav-bar").find("ul.wb-dropdown").hide(),clearTimeout(o),o=n),t.children("ul").show()},function(){o&&(clearTimeout(o),o=n),t.find("#layout-input:focus").size()==0?o=setTimeout(function(){t.children("ul").hide()},300):t.find("#layout-input").blur(function(){o=setTimeout(function(){t.children("ul").hide()},600)})}),s("#nav-min").click(function(){var e=s(".navigation-min").add("#navigation"),t=s("#page-title"),n=e.width(),r="open sidebar",i="-1em";n==0?(n="12em",r="close sidebar",i=175):n=0,e.animate({width:n}).show().children("#title").children("div").toggle(),t.animate({marginLeft:i}).show(),s(this).attr("title",r).children("#nav-min-icon").toggleClass("ui-icon-triangle-1-w").toggleClass("ui-icon-triangle-1-e")}),s("#hide-empty-fields").click(function(){s(".disabled").toggle(),s(this).toggleClass("ui-state-highlight")}),e.size()>0&&S(e,e.attr("href"),n,function(){e.delegate(".results-person .result li a","click",function(){s(".ui-state-highlight").removeClass("ui-state-highlight");var e=s(this).attr("href").split("/").pop();return s.ajax({type:"GET",url:"/auth/info/"+e,dataType:"json",success:function(e){var t=s("#link-account");if(t.size()==0){s("input#name").attr("value",e.fullname).attr("disabled","disabled");var n=new String(e.email);if(e.email&&e.status_ok){var r=new RegExp(s("input#email").attr("value"),"gi");(n.match(r)||!s("input#email").attr("value"))&&s("#email").attr("disabled","disabled").parent().hide(),s("input#wbemail").attr("value",n).parent().show()}else s("input#wbemail").attr("value","").parent().hide(),s("#email").removeAttr("disabled").parent().show();s(".register-notice").html("<span id='fade'>"+e.message+"</span>").show(),s("input#wbid").attr("value",e.wbid)}else{s("input#wbid").attr("value",e.wbid),s("input#email").attr("value",e.email),t.removeAttr("disabled"),s("input#confirm").attr("value","");var i=["[% emails.join('","') %]"];if(e.email&&e.status_ok){var o=""+e.email;for(var u=0;u<i.length;u++){var r=new RegExp(i[u],"gi");if(o.match(r)){s(".register-notice").css("visibility","hidden"),s("input#confirm").attr("value",1);return}}}else t.attr("disabled",1);s(".register-notice").html("<span id='fade'>"+e.message+"</span>").css("visibility","visible")}},error:function(e,t,n){alert(e+" "+t+" "+n)}}),s(this).parent().parent().addClass("ui-state-highlight"),!1})})}function m(){function a(e){var t=0;for(var n=-1,r=e.length;n++<r;)t+=e.eq(n).height();return t}var n=s("#widget-holder"),i=s("#widgets"),o=s(".list-layouts"),u;if(n.size()==0){s("#content").addClass("bare-page");return}q.sidebarInit(),e.onhashchange=I.readHash,e.onresize=I.resize,I.Breadcrumbs.init(),r.hash.length>0?I.readHash():(u=n.data("layout"))?I.resetPageLayout(u):I.openAllWidgets(),i.find(".module-load, .module-close").click(function(){var e=s(this).attr("wname"),t=s("#nav-"+e),r=s("#"+e+"-content");if(!t.hasClass("ui-selected")){if(r.text().length<4){var i=".left",o=I.getLeftWidth(n);if(o>=90)n.children(".right").children(".visible").height()&&(i=".right");else{var u=a(n.children(".left").children(".visible"));rightHeight=a(n.children(".right").children(".visible")),rightHeight<u&&(i=".right")}B(e,t,r,i)}else r.parents("li").addClass("visible"),t.addClass("ui-selected"),y(r.prev().find(".module-min"),!1,"maximize");q.goToAnchor(e),I.updateLayout()}else q.scrollUp(r.parents("li")),y(r.prev().find(".module-min"),!1,"minimize",function(){t.removeClass("ui-selected"),r.parents("li").removeClass("visible"),I.updateLayout()});return q.sidebarMove(),!1}),n.children("#widget-header").disableSelection(),n.find(".module-max").click(function(){var n=s(this).parents(".widget-container"),r=n.clone(),i=e.open("","test","height="+n.height()+",width="+n.width());i.document.write(t.head.innerHTML),i.document.write(r.html())}),i.find(".module-load, .module-close").bind("open",function(){var e=s(this).attr("wname"),t=s("#nav-"+e),n=s("#"+e+"-content");return B(e,t,n,".left"),!1}),n.find(".module-min").click(function(){y(s(this),!0)}),n.find(".reload").click(function(){j(s(this).attr("wname"))}),s(".feed").click(function(){var e=s(this).attr("rel"),t=s(this).parent().next("#widget-feed");t.filter(":hidden").empty().load(e),t.slideToggle("fast")})}function g(){var e=s("#content");s("body").delegate(".toggle","click",function(){var e=s(this);return e.toggleClass("active").next().slideToggle("fast",function(){s.colorbox&&s.colorbox.resize(),q.sidebarMove()}),e.hasClass("load-toggle")&&(S(e.next(),e.attr("href")),e.removeClass("load-toggle")),e.children(".ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s"),!1}),e.delegate(".evidence","click",function(){var e=s(this);e.children(".ev-more").toggleClass("open").children(".ui-icon").toggleClass("ui-icon-triangle-1-s ui-icon-triangle-1-n"),e.children(".ev").toggle("fast")}),e.delegate(".slink","mouseover",function(){var e=s(this);et.getPlugin("colorbox",function(){e.colorbox({data:e.attr("href"),width:"800px",height:"550px",scrolling:!1,onComplete:function(){s.colorbox.resize()},title:function(){return e.next().text()+" "+e.data("class")}})})}),e.delegate(".bench-update","click",function(){var e=s(this),t=e.attr("wbid"),n=e.attr("save_to"),r=e.attr("ref")+"?name="+escape(e.attr("name"))+"&url="+escape(e.attr("href"))+"&save_to="+n+"&is_obj="+e.attr("is_obj");return s(".star-status-"+t).find("#save").toggleClass("ui-icon-star-yellow ui-icon-star-gray"),s("#bench-status").load(r,function(){s("div#"+n+"-content").text().length>3&&j(n,1)}),!1}),s("body").delegate(".generate-file-download","click",function(e){var t=s(this).find("#filename").text(),n=s(this).find("#content").text();et.getPlugin("generateFile",function(){s.generateFile({filename:t,content:n,script:"/rest/download"})})})}function y(e,t,n,r){var i=s("#"+e.attr("wname")+"-content");if(n&&e.attr("title")!=n){r&&r();return}i.slideToggle("fast",function(){q.sidebarMove(),r&&r()}),e.toggleClass("ui-icon-triangle-1-s ui-icon-triangle-1-e").closest(".widget-container").toggleClass("minimized"),t&&e.toggleClass("ui-icon-circle-triangle-e ui-icon-circle-triangle-s"),e.attr("title")!="maximize"?e.attr("title","maximize").addClass("show"):e.attr("title","minimize").removeClass("show"),i.find(".cyto_panel").each(function(e,t){t.selectedIndex=0})}function b(e){u&&(clearTimeout(u),u=n);var t=s("#notifications");t.show().children("#notification-text").text(e),u=setTimeout(function(){t.fadeOut(400)},3e3),t.click(function(){u&&(clearTimeout(u),u=n),s(this).hide()})}function w(e,t){var r=s(".system-message"),i=s("#notifications");e=="show"?(i.css("top","20px"),q.set_system_message(20)):(r.animate({height:"0px"},"slow",n,function(){s(this).hide()}),s.post("/rest/system_message/"+t),q.set_system_message(0),i.css("top","0"))}function E(e){e.html('<div class="loading"><img src="/img/ajax-loader.gif" alt="Loading..." /></div>')}function S(e,t,n,i){s.ajax({url:t,beforeSend:function(){n||E(e)},success:function(t){e.html(t)},error:function(t,n,i){var o=s(t.responseText).find(".error-message-technical").html()||"";e.html('<div class="ui-state-error ui-corner-all"><p><strong>Sorry!</strong> An error has occured.</p><p><a href="/tools/support?url='+r.pathname+(o?"&msg="+encodeURIComponent(o.trim()):"")+'">Let us know</a></p><p>'+o+"</p></div>")},complete:function(e,t){i&&i()}})}function x(){var e,t=!1;s("#operator-box").click(function(){var e=s(this);t||(S(s("#operator-box"),"/rest/livechat",0),t=!0),e.hasClass("minimize")?e.animate({width:"9em"}).children().show():e.animate({width:"1.5em"}).children().hide(),e.toggleClass("minimize")}),s(".operator").click(function(){if(s(this).attr("rel"))s.post("/rest/livechat?open=1",function(){r.href="/tools/operator"});else{var n=s("#operator-box");S(n,"/rest/livechat",0),t=!0,n.hasClass("minimize")&&n.removeClass("minimize").animate({width:"9em"}).children().show(),e=setTimeout(function(){n.addClass("minimize").animate({width:"1.5em"}).children().hide()},4e3)}}),s("#issue-box").click(function(){var e=s(this);e.toggleClass("minimize").children().toggle(),e.animate({width:e.hasClass("minimize")?"1em":"14em"})})}function T(e){var t=s(e);t.attr("value")!=""&&t.siblings(".holder").fadeOut(),t.focus(function(){s(this).siblings(".holder").fadeOut()}),t.blur(function(){s(this).attr("value")==""&&s(this).siblings(".holder").fadeIn()})}function N(){var e=s("#Search"),t="search...",n=s("#searchForm"),i;e.focus(function(e){s(this).addClass("active")}),e.blur(function(e){s(this).removeClass("active")}),e.focus(function(){s(this).attr("value")==t&&s(this).attr("value","")}),e.blur(function(){s(this).attr("value")==""&&s(this).attr("value",t)}),e.autocomplete({source:function(e,t){i=s.getJSON("/search/autocomplete/"+a,e,function(e,n,r){r===i&&t(e)})},minLength:3,select:function(e,t){r.href=t.item.url}})}function C(e){e?a=a||"all":e="Search";var t=s("#"+e).attr("value");if(t=="search..."||!t)t="";t=encodeURIComponent(t.trim()),t=t.replace("%26","&"),t=t.replace("%2F","/"),r.href="/search/"+a+"/"+t+(f?"?species="+f:"")}function k(e){e||(e="gene"),a=e;if(e=="all")e="for anything";else{var t="for a";e.match(/^[aeiou]/)&&(t+="n"),e=t+" "+e.replace(/[_]/," ")}s(".current-search").text(e)}function L(e){f=e,e=="all"?e="all species":(e=e.charAt(0).toUpperCase()+e.slice(1),e=e.replace(/[_]/,". ")),s(".current-species-search").text(e)}function A(e){var t=e.find("#results"),r=t.size()>0?t.data("search"):n;if(!r){O(t);return}M(r.query,r.type,r.species,r.widget,r.nostar,r.count,e)}function O(e){var t=e.find(".text-min");for(var n=-1,r,i=t.size();(r=t.eq(++n))&&n<i;)r.height()>35&&r.html('<div class="text-min-expand">'+r.html()+'</div><div class="more"><div class="ui-icon ui-icon-triangle-1-s"></div></div>').click(function(){var e=s(this),t=e.children(".text-min-expand");t.animate({height:t.height()<40?"100%":"2.4em"}).css("max-height","none").next().toggleClass("open").children().toggleClass("ui-icon-triangle-1-s ui-icon-triangle-1-n"),e.parent().find(".expand").toggleClass("ellipsis")})}function M(e,t,n,r,i,o,u){function v(){u.find("#results").find(".load-star").each(function(){s(this).load(s(this).attr("href"))})}function m(e){O(e);if(d.length==0)return;et.getPlugin("highlight",function(){for(var t=0;t<d.length;t++)d[t]&&e.highlight(d[t])})}var a=decodeURI(e),f=1,l=o,h=u.find("#count"),p=u.find((r?"."+r+"-widget ":"")+".load-results"),d=a?a.replace(/[,\.\*]/," ").split(" "):[];m(u.find("div#results")),v(),l>10&&(u.find(".lazyload-widget").size()>0&&q.search(),p.click(function(){var e=s(this).attr("href")+(f+1)+"?"+(n?"species="+n:"")+(r?"&widget="+r:"")+(i?"&nostar="+i:"");div=s("<div></div>"),res=s((r?"."+r+"-widget":"")+" #load-results"),s(this).removeClass("load-results"),f++,E(div),res.html("loading..."),div.load(e,function(e,t,n){l=div.find("#page-count").data("count")||l;var r=l-f*10;r>0?(r>10&&(r=10),res.addClass("load-results"),res.html("load "+r+" more results")):res.remove(),m(div);if(t=="error"){var i="Sorry but there was an error: ";s(this).html(i+n.status+" "+n.statusText)}q.sidebarMove(),div.find(".load-star").each(function(){s(this).load(s(this).attr("href"))}),h.html(l)}),div.appendTo(s(this).parent().children("ul")),c++,q.sidebarMove()}))}function _(e){var t=s("#all-search-results");return t.empty(),S(t,e,n,function(){A(t)}),c=0,t.hasClass("references")||D(),!1}function D(){return s(e).scrollTop(0),q.resetSidebar(),n}function P(e,t,r,i){var o="/search/"+e+"/"+r+"/?inline=1",u=s("#all-search-results");i||(q.sidebarInit(),k(e)),t&&(o=o+"&species="+t),S(u,o,n,function(){A(u)}),s("#search-count-summary").find(".count").each(function(){s(this).load(s(this).attr("href"),function(){s(this).text()=="0"?s(this).parent().remove():s(this).parent().show().parent().prev(".title").show()})}),s("#search-count-summary").find(".load-results").click(function(){var e=s(this);return _(e.attr("href")),e.addClass("ui-selected").siblings().removeClass("ui-selected").parent().siblings().find(".ui-selected").removeClass("ui-selected"),s("#curr-ref-text").html(e.html()),!1}),e=="paper"&&I.resize()}function H(e,t,n){try{var r=_gat._createTracker("UA-16257183-1");r._trackEvent(t,n)}catch(i){}}function B(e,t,r,i){var o=t.attr("href");return r.closest("li").appendTo(s("#widget-holder").children(i)),r.text().length<4&&(F(r.parent(".widget-container")),S(r,o,n,function(){q.sidebarMove(),A(r)})),y(r.prev().find(".module-min"),!1,"maximize"),t.addClass("ui-selected"),r.parents("li").addClass("visible"),!1}function j(e,t,n){var r=s("#"+e+"-content");r.text().length>4&&S(r,n||s("#nav-"+e).attr("href"),t,function(){A(r)})}function F(e){e.find("div.module-min").hover(function(){var e=s(this);e.addClass(e.hasClass("show")?"ui-icon-circle-triangle-e":"ui-icon-circle-triangle-s")},function(){var e=s(this);e.removeClass("ui-icon-circle-triangle-s ui-icon-circle-triangle-e").addClass(e.hasClass("show")?"ui-icon-triangle-1-e":"ui-icon-triangle-1-s")}),e.find("div.module-close").hover(function(){s(this).toggleClass("ui-icon-circle-close ui-icon-close")})}function R(e){var t=s(".comment-count");t.size()>0&&t.load("/rest/feed/comment?count=1;url="+e)}function U(e,t,n,r,i){if(e.val()==""&&(!i||i.val()==""))return e.focus().addClass("ui-state-error"),!1;if(e.val()&&z(e.val(),"Not a valid email address!")==0)return e.focus().addClass("ui-state-error"),!1;if(!n)return t&&t.val()==""?(t.focus().addClass("ui-state-error"),!1):!0;if(n.val()=="")return n.focus().addClass("ui-state-error"),!1;if(r&&n.val()!=r.val())return alert("The passwords do not match. Please enter again"),n.focus().addClass("ui-state-error"),!1}function z(e,t){var n=e.indexOf("@"),r=e.lastIndexOf(".");return n<1||r-n<2?(alert(t),!1):!0}function $(e,t,r){e=="get"?et.getPlugin("colorbox",function(){s(".history-logging").colorbox(),r&&r()}):(s.post("/rest/history",{history_on:t},function(){r&&r()}),p(t==1?1:n),s.colorbox&&s.colorbox.close())}function J(e,t){var n=s("#"+e);E(n),et.getPlugin("jGFeed",function(){s.jGFeed(t,function(e){if(!e)return!1;var t='<div id="results"><ul>';for(var r=-1,i;i=e.entries[++r];)t+='<div class="result"><li><div class="date" id="fade">'+i.publishedDate.substring(0,16)+"</div>"+'<a href="'+i.link+'">'+i.title+"</a></li>"+'<div class="text-min">'+i.content.replace(/(\<\/?p\>|\<br\>)/g,"")+"</div></div>";t+="</ul></div>",n.html(t),O(n)},3)})}function Y(t,n){var r=["#08298A","#B40431","#FF8000","#04B404","#8000FF","#191007","#73c6cd","#92d17b","#cC87AB4","#e4e870","#696D09"],i={attrName:"type",entries:[]},o={attrName:"direction",entries:[{attrValue:"Effector->Effected",value:"T"}]},u={attrName:"direction",entries:[{attrValue:"Effector->Effected",value:"ARROW"}]},a={attrName:"ntype",entries:[{attrValue:"Sequence",value:"TRIANGLE"},{attrValue:"PCR product",value:"HEXAGON"},{attrValue:"CDS",value:"DIAMOND"},{attrValue:"Gene",value:"OCTAGON"},{attrValue:"Protein",value:"RECTANGLE"},{attrValue:"Molecule",value:"PARALLELOGRAM"},{attrValue:"Other",value:"ELLIPSE"}]},f={attrName:"width",minValue:3,maxValue:15,maxAttrValue:15},l={attrName:"number",minValue:"#04043D",maxValue:"#6FA2D9"},c={attrName:"phenotype",entries:[{attrValue:"",value:"<b>${type}<br />${direction}<br />${source} --- ${target}<br />${width} citation(s)</b>"}]},h={dataSchema:{nodes:[{name:"label",type:"string"},{name:"number",type:"int"},{name:"color",type:"string"},{name:"ntype",type:"string"},{name:"link",type:"string"}],edges:[{name:"label",type:"string"},{name:"type",type:"string"},{name:"direction",type:"string"},{name:"width",type:"int"},{name:"phenotype",type:"string"},{name:"nearby",type:"int"}]},data:t},p={global:{backgroundColor:"#ffffff",tooltipDelay:100},nodes:{shape:"OCTAGON",opacity:.7,borderWidth:0,hoverGlowOpacity:.8,size:30,tooltipText:"<b>${label} (${ntype})</b>",tooltipBackgroundColor:"#fafafa",shape:{discreteMapper:a},color:{continuousMapper:l},hoverGlowColor:"#aae6ff",labelGlowOpacity:1,labelHorizontalAnchor:"center"},edges:{width:{defaultValue:.5,continuousMapper:f},color:{defaultValue:"#999999",discreteMapper:i},opacity:.4,hoverOpacity:1,sourceArrowShape:{defaultValue:"NONE",discreteMapper:o},targetArrowShape:{defaultValue:"NONE",discreteMapper:u},labelHorizontalAnchor:"center",label:{passthroughMapper:{attrName:"type"}},tooltipText:{defaultValue:"<b>${type}<br />${direction}<br />${source} --- ${target}<br />${phenotype}<br />${width} citation(s)</b>",discreteMapper:c},tooltipBackgroundColor:"#fafafa"}},d={swfPath:"/js/jquery/plugins/cytoscapeweb/swf/CytoscapeWeb",flashInstallerPath:"/swf/playerProductInstall"};for(var v=-1,m;m=n[++v];)p.edges.color.discreteMapper.entries[v]={attrValue:m,value:r[v]};et.getPlugin("cytoscape_web",function(){var t=new org.cytoscapeweb.Visualization("cytoscapeweb",d);t.draw({network:h,visualStyle:p,nodeTooltipsEnabled:!0,edgeTooltipsEnabled:!0}),t.ready(function(){t.filter("nodes",function(e){return e.data.ntype=="Gene"||e.data.ntype=="Other"||e.data.ntype=="Molecule"}),t.addListener("click","nodes",function(t){e.open(t.target.data.link)})}),s(".cyto_panel").change(function(){var e=s("#cyto_panel_direction option:selected").val(),n=s("#cyto_panel_type option:selected").val(),r=s("#cyto_panel_nearby option:selected").val(),i=s("#cyto_panel_nodetype option:selected").val();i==0?t.removeFilter("nodes",!0):t.filter("nodes",function(e){return e.data.ntype==i}),e==0&&n==0&&r==0?t.filter("edges",function(e){return e.data.type!="No_interaction"},!0):t.filter("edges",function(t){return e!=0&&n!=0&&r!=0?t.data.type==n&&t.data.direction==e&&t.data.nearby==0:e!=0&&r!=0?t.data.direction==e&&t.data.nearby==0&&t.data.type!="No_interaction":e!=0&&n!=0?t.data.type==n:e!=0?t.data.direction==e&&t.data.type!="No_interaction":n!=0&&r!=0?t.data.type==n&&t.data.nearby==0:r!=0?t.data.nearby==0&&t.data.type!="No_interaction":t.data.type==n},!0)})}),s("#resizable").resizable()}function Z(e){et.getPlugin("markitup",function(){et.getPlugin("markitup-wiki",e)});return}var o,u,a="all",f="",l=0,c=0,I=function(){function h(){u!=(u=t.documentElement.clientWidth<c)&&(u?p(100,100):b(),(multCol=s("#column-dropdown").find(".multCol"))&&multCol.toggleClass("ui-state-disabled")),c>1e3&&f.children(".sortable").hasClass("table-columns")&&f.children(".left").width()+f.children(".right").width()>f.outerWidth()+150&&p(100,100),a&&a.hasClass("widget-narrow")!=a.innerWidth()<845&&a.toggleClass("widget-narrow")}function p(e,t,n){var r=f.children(".sortable"),i=f.innerWidth(),e=u?100:e;e>95?(f.removeClass("table-columns").addClass("one-column"),t=e=100):f.addClass("table-columns").removeClass("one-column"),r.filter(".left").css("width",e+"%"),r.filter(".right").css("width",t+"%"),n||x()}function d(e){var t=f.attr("wclass");s.get("/rest/layout/"+t+"/"+e+"?delete=1"),s("div.columns ul div li#layout-"+e).remove()}function v(e){var t=f.attr("wclass");s.get("/rest/layout/"+t+"/"+e,function(e){var t=e.childNodes[0].childNodes,n=t.length;for(i=0;i<n;i++){var s=t.item(i);s.nodeName=="data"&&(r.hash=s.attributes.getNamedItem("lstring").nodeValue)}},"xml")}function m(e){e=e||f.data("layout"),e.hash?r.hash=e.hash:(C(e.leftlist,e.rightlist||[],e.leftwidth||100),l++,x())}function g(e){return x(e,n,function(){s(".list-layouts").load("/rest/layout_list/"+s(".list-layouts").data("class")+"?section="+s(".list-layouts").data("section"),function(e,t,n){if(t=="error"){var r="Sorry but there was an error: ";s(".list-layouts").html(r+n.status+" "+n.statusText)}})}),o&&(clearTimeout(o),o=n),o=setTimeout(function(){s("#column-dropdown").children("ul").hide()},700),!1}function y(e,t,n){var i=s.map(e,function(e){return w(e)}),o=s.map(t,function(e){return w(e)}),u=i.join("")+"-"+o.join("")+"-"+n/10;return r.hash&&decodeURI(r.hash).match(/^[#](.*)$/)[1]!=u&&l++,r.hash=u,u}function b(){if(l==0){var e=r.hash,t,i=(t=decodeURI(e).match(/^[#](.*)$/))?t[1].split("-"):n;if(!i)return;var o=i[0],u=i[1],a=i[2]*10;o&&(o=s.map(o.split(""),function(e){return S(e)})),u&&(u=s.map(u.split(""),function(e){return S(e)})),C(o,u,a,e)}else l--}function w(e){return widgetList.list.indexOf(e).toString(36)}function E(){var t="",n=s("#navigation").find("li.module-load:not(.tools,.me,.toggle)").size();if(widgetList.list.length==0)return;for(i=0;i<n;i++)t+=i.toString(36);return e.location.hash=t+"--10",!1}function S(e){return widgetList.list[parseInt(e,36)]}function x(e,t,n){var r=f.attr("wclass"),i=t||T(f),o=typeof e=="string"?escape(e):"default";s.post("/rest/layout/"+r+"/"+o,{lstring:i},function(){I.resize(),n&&n()})}function T(e){var t=e.children(".left").children(".visible").map(function(){return this.id}).get(),n=e.children(".right").children(".visible").map(function(){return this.id}).get(),r=N(e);return y(t,n,r)}function N(e){var t=u?decodeURI(r.hash).match(/^[#](.*)$/)[1].split("-")[2]*10:parseFloat(e.children(".left").outerWidth())/parseFloat(e.outerWidth())*100;return Math.round(t/10)*10}function C(e,t,i,o){s("#navigation").find(".ui-selected").removeClass("ui-selected"),s("#widget-holder").children().children("li").removeClass("visible"),p(i,100-i,1);for(var u=0,a=e?e.length:0;u<a;u++){var f=s.trim(e[u]);if(f.length>0){var l=s("#nav-"+f),c=s("#"+f+"-content");B(f,l,c,".left")}}for(var u=0,a=t?t.length:0;u<a;u++){var f=s.trim(t[u]);if(f.length>0){var l=s("#nav-"+f),c=s("#"+f+"-content");B(f,l,c,".right")}}r.hash.length>0&&x(n,o)}var u=!1,a=s("#references-content"),f=s("#widget-holder"),c=r.pathname=="/"||r.pathname=="/me"?900:1300;widgetList=this.wl||function(){var e=this,t=s("#navigation"),n=t.find(".module-load").map(function(){return this.getAttribute("wname")}).get();return this.wl={list:n},this.wl}();var k=function(){function o(){if(!e||(i=e.children().size())<3)return;var o=e.children(),f=o.slice(0,i-2),l=o.slice(i-2),c;e.empty(),n=s('<span id="breadcrumbs-hide"></span>'),n.append(f).children().after(" &raquo; "),e.append('<span id="breadcrumbs-expand" class="ui-icon-large ui-icon-triangle-1-e tl" tip="exapand"></span>').append(n).append(l),e.children(":last").addClass("page-title").before(" &raquo; "),c=s("#breadcrumbs-expand"),c.click(function(){(t=!t)?u(s(this)):a(s(this))}),r=n.width(),a(c)}function u(e){n.animate({width:r},function(){n.css("width","auto")}).css("visibility","visible"),e.attr("tip","minimize").removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-w")}function a(e){n.animate({width:0},function(){n.css("visibility","hidden")}),e.attr("tip","expand").removeClass("ui-icon-triangle-1-w").addClass("ui-icon-triangle-1-e")}var e=s("#breadcrumbs"),t=!1,n,r,i;return{init:o}}();return{resize:h,deleteLayout:d,columns:p,openAllWidgets:E,resetLayout:C,setLayout:v,resetPageLayout:m,readHash:b,getLeftWidth:N,updateLayout:x,Breadcrumbs:k,newLayout:g}}(),q=function(){function m(){o=0,a.stop().css("position","relative").css("top",0)}function g(e){var r=t.getElementById(e),o=b(r)?n:s(r).offset().top-i-10;o&&(h.stop().animate({scrollTop:o},2e3,function(){q.sidebarMove(),p=0}),p=h.scrollTop()<o?1:0)}function y(e){var t=s(e).offset().top+s(e).height(),n=r.scrollTop()+r.height();t<=n&&h.stop().animate({scrollTop:r.scrollTop()-e.height()-10},"fast",function(){q.sidebarMove()})}function b(e){var t=r.scrollTop(),n=t+r.height()*.75,i=s(e).offset().top,o=i+s(e).height();return o>=t&&i<=n}function w(){if(!a)return;if(a.offset()){var e=a.outerHeight()<r.height()-i,n=r.scrollTop(),c=s(t).height()-(a.outerHeight()+u+i+20);if(a.outerHeight()>l.height()){m();return}e?o==0?n>=f&&n<=c?(a.stop().css("position","fixed").css("top",i),o=1):n>c?a.stop().css("position","fixed").css("top",i-(n-c)):m():n<f?m():n>c&&(a.stop().css("position","fixed").css("top",i-(n-c)),o=0,p==1&&(h.stop(),p=0)):d==0&&(v=a.find(".ui-icon-triangle-1-s:not(.pcontent)"))?(d++,v.last().parent().click().delay(250).queue(function(){d--,q.sidebarMove()})):m()}}function E(){a=s("#navigation"),f=a.offset().top,l=s("#widget-holder"),r.scroll(function(){q.sidebarMove()})}function x(e){i=e}var r=s(e),i=0,o=0,u=s("#footer").outerHeight(),a,f,l,h=s("html,body"),p=0,d=0,v,S=function(){if(c>=6)return;r.scroll(function(){var e=s("#results");if(e.offset()&&c<6){var t=e.height()+e.offset().top,n=t-(r.height()+r.scrollTop());n<400&&e.children(".load-results").trigger("click")}})};return{sidebarInit:E,search:S,set_system_message:x,sidebarMove:w,resetSidebar:m,goToAnchor:g,scrollUp:y}}();Array.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1});var W={init:function(e){W.url=e.ref},submit:function(e){var t=e.closest("#comment-new"),n=t.find(".comment-content").val();if(n==""||n=="write a comment...")return alert("Please provide your name & comment"),!1;s.ajax({type:"POST",url:"/rest/feed/comment",data:{content:n,url:W.url},success:function(e){b("Comment Submitted!"),t.find("#comment-box").prepend(e),t.find(".comment-content").val("write a comment..."),R(url)},error:function(e,t,n){alert(e+" "+t+" "+n)}});var r=s('<div class="comment-box"><a href="/me">'+name+"</a> "+n+'<br /><span id="fade">just now</span></div>'),i=s("#comments");return i.prepend(r),!1},cmDelete:function(e){var t=e.attr("id"),n=e.attr("rel");s.ajax({type:"POST",url:n,data:{method:"delete",id:t},success:function(e){R(n)},error:function(e,t,n){alert(e+" "+t+" "+n)}}),e.parent().remove()}},X={init:function(e){X.url=e.ref},submit:function(e){var t=e.attr("rel"),n=e.attr("url"),r=e.closest("#issues-new"),i=r.find("#name"),o=r.find("#desc-content"),u=r.find("#email");if(!U(u,i))return;return s.ajax({type:"POST",url:t,data:{title:r.find("#issue-title option:selected").val(),content:r.find("#issue-content").val()+(o.length>0?"<br />What were you doing?: <br />&nbsp;&nbsp;"+o.val():""),name:i.val(),email:u.val(),url:n||X.url},success:function(e){if(e==0)alert("The email address has already been registered! Please sign in.");else{var t=s("#content");t.children().not("#spacer").remove(),t.prepend(e)}},error:function(e,t,n){alert(e+" "+t+" "+n)}}),!1},isDelete:function(t){var n=t.attr("rel"),r=new Array;s(".issue-deletebox").filter(":checked").each(function(){r.push(s(this).attr("name"))});var i=confirm("Do you really want to delete these issues: #"+r.join(" #"));i&&s.ajax({type:"POST",url:n,data:{method:"delete",issues:r.join("_")},success:function(t){e.location.reload(1)},error:function(e,t,n){alert(e+" "+t+" "+n)}})},update:function(t,n){var r=t.attr("rel"),i=t.closest("#threads-new");return s.ajax({type:"POST",url:r,data:{content:s("textarea").val(),issue:n,state:s("#issue_status option:selected").val(),severity:s("#issue_severity option:selected").val(),assigned_to:s("#issue_assigned_to option:selected").val()},success:function(t){e.location.reload()},error:function(e,t,n){}}),!1}},V={update:function(e,t){e||(e="0");var n=s("li#static-widget-"+e),r=n.find("input#widget_title").val(),i=n.find("input#widget-order").val(),o=n.find("textarea#widget_content").val();s.ajax({type:"POST",url:"/rest/widget/static/"+e,dataType:"json",data:{widget_title:r,path:t,widget_content:o,widget_order:i},success:function(t){V.reload(e,0,t.widget_id)},error:function(e,t,n){alert(e+" "+t+" "+n)}})},edit:function(e,t){var n=e.split("-").pop(),r=s("#"+e+"-content"),i=r.parent(),o=i.find("a#edit-button");o.hasClass("ui-state-highlight")?V.reload(n):(o.addClass("ui-state-highlight"),r.load("/rest/widget/static/"+n+"?edit=1"))},reload:function(e,t,n){var r=s("#static-widget-"+e+"-content"),i=r.parent(),o=i.find("h3 span.widget-title input"),u="/rest/widget/static/"+(n||e);o.size()>0&&o.parent().html(o.val()),i.find("a.button").removeClass("ui-state-highlight"),s("#nav-static-widget-"+e).text(o.val()),t&&(u=u+"?rev="+t),r.load(u)},delete_widget:function(e){confirm("are you sure you want to delete this widget?")&&s.ajax({type:"POST",url:"/rest/widget/static/"+e+"?delete=1",success:function(t){s("#nav-static-widget-"+e).click().hide()},error:function(e,t,n){alert(e+" "+t+" "+n)}})},history:function(e){var t=s("#"+e),n=t.find("div#"+e+"-history");if(n.size()>0)n.toggle(),t.find("a#history-button").toggleClass("ui-state-highlight");else{var r=e.split("-").pop(),n=s('<div id="'+e+'-history"></div>');n.load("/rest/widget/static/"+r+"?history=1"),t.find("div.content").append(n),t.find("a#history-button").addClass("ui-state-highlight")}}},K={google:{name:"Google",url:"https://www.google.com/accounts/o8/id"},facebook:{name:"Facebook",url:"http://facebook.anyopenid.com/"}},Q=s.extend({},K),G={signin:function(e,t){var n=Q[e];if(!n)return;var i="/auth/popup?id="+e+"&url="+n.url+"&redirect="+r;this.popupWin(i)},popupWin:function(t){var n=400,r=600,i=screen.width/2-r/2,s=screen.height/2-n/2,o=e.open(t,"popup","status=no,resizable=yes,height="+n+",width="+r+",left="+i+",top="+s+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no");o.focus()}},et=function(){function o(t,n,r,i){function s(){u(n,!0,function(){e[t]=!0,i()})}r?u(r,!1,s()):s()}function u(e,i,s){function f(){a=!0,r=!1,s&&s()}var o=t.documentElement,u=t.createElement(i?"script":"link"),a=!1;r=!0,i?u.src=e:(u.href=e,u.rel="stylesheet",u.type="text/css");if(i)u.onload=u.onreadystatechange=function(){!a&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(f(),u.onload=u.onreadystatechange=null,o&&u.parentNode&&o.removeChild(u))};else{u.onload=function(){f()},u.addEventListener&&u.addEventListener("load",function(){f()},!1),u.onreadystatechange=function(){var e=u.readyState;if(e==="loaded"||e==="complete")u.onreadystatechange=null,f()};var l=t.styleSheets.length,c=setInterval(function(){t.styleSheets.length>l&&(f(),clearInterval(c))},10)}return o.insertBefore(u,o.firstChild),n}function a(e,t){var n=i[e],r=s[e];f(e,n,r,t);return}function f(t,n,i,s){if(!e[t])o(t,n,i,s);else{if(r)return setTimeout(a(t,n,i,s),1);s()}return}var e=new Array,r=!1,i={highlight:"/js/jquery/plugins/jquery.highlight-1.1.js",dataTables:"/js/jquery/plugins/dataTables/media/js/jquery.dataTables.min.js",colorbox:"/js/jquery/plugins/colorbox/colorbox/jquery.colorbox-min.js",jGFeed:"/js/jquery/plugins/jGFeed/jquery.jgfeed-min.js",generateFile:"/js/jquery/plugins/generateFile.js",pfam:"/js/pfam/domain_graphics.min.js",markitup:"/js/jquery/plugins/markitup/jquery.markitup.js","markitup-wiki":"/js/jquery/plugins/markitup/sets/wiki/set.js",cytoscape_web:"/js/jquery/plugins/cytoscapeweb/js/min/cytoscapeweb_all.min.js"},s={dataTables:"/js/jquery/plugins/dataTables/media/css/demo_table.css",colorbox:"/js/jquery/plugins/colorbox/colorbox/colorbox.css",markitup:"/js/jquery/plugins/markitup/skins/markitup/style.css","markitup-wiki":"/js/jquery/plugins/markitup/sets/wiki/style.css"};return{getPlugin:a}}();return{init:h,ajaxGet:S,hideTextOnFocus:T,goToAnchor:q.goToAnchor,setLoading:E,resetLayout:I.resetLayout,openAllWidgets:I.openAllWidgets,displayNotification:b,deleteLayout:I.deleteLayout,columns:I.columns,setLayout:I.setLayout,resetPageLayout:I.resetPageLayout,search:C,search_change:k,search_species_change:L,openid:G,validate_fields:U,StaticWidgets:V,recordOutboundLink:H,comment:W,issue:X,getMarkItUp:Z,checkSearch:A,scrollToTop:D,historyOn:$,allResults:P,loadRSS:J,newLayout:I.newLayout,setupCytoscape:Y,getPlugin:et.getPlugin,reloadWidget:j}}();s(t).ready(function(){s.ajaxSetup({timeout:12e4}),e.WB||(o.init(),e.WB=o,e.$jq=s)})}(this,document),typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t})